<input name="dates" class="form-control" value=''>
<%= form_for [@listing, Reservation.new] do |form| %>

  <div class="form-group">
    <%= form.hidden_field :start_time, class: 'form-control', placeholder: 'Start' %>
  </div>

  <div class="form-group">
    <%= form.hidden_field :end_time, class: 'form-control', placeholder: 'End' %>

  </div>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>

<script>
var startDate;
var endDate;

$(function() {

  $('input[name="dates"]').daterangepicker({
    autoUpdateInput: false,
    opens: 'left',
    minDate: moment(),
    locale: {
          cancelLabel: 'Clear'
      },
    "applyButtonClasses": "btn-danger"
  }, function(start, end, label) {
    console.log("A new date selection was made: " + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
    startDate = start.format('YYYY-MM-DD');
    endDate = end.format('YYYY-MM-DD');
    $('input[name="reservation[start_time]"]').val(startDate);
    $('input[name="reservation[end_time]"]').val(endDate);
  });
  $('input[name="dates"]').on('apply.daterangepicker', function(ev, picker) {
      $(this).val(picker.startDate.format('MM/DD/YYYY') + ' - ' + picker.endDate.format('MM/DD/YYYY'));
  });

  $('input[name="dates"]').on('cancel.daterangepicker', function(ev, picker) {
      $(this).val('');
      $('input[name="reservation[start_time]"]').val('');
      $('input[name="reservation[end_time]"]').val('');
  });
});


</script>
